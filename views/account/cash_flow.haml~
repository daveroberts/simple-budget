%div= render :partial => 'date/range', :locals => { :from_date => @from_date, :to_date=>@to_date, :id=>@account.owner.id }
%h1= "Cash Flow Statement for Account: #{@account.name}"
%p= link_to_function "Add New Entry", visual_effect(:toggle_slide, :newEntry)
%div{:id=>"newEntry", :style=>"display: none"}
  - form_tag({:controller=>"entry", :action=>"new", :account_id=>@account.id}) do
    %fieldset
      %legend New Entry
      %div= render :partial => "entry/entry"
      %p
        .entry= submit_tag 'Add new entry'
= "Balance: #{number_to_currency(@account.balance)}"
%table
  %thead
    %tr
      %th Date
      %th Description
      %th
      %th Amount
      %th Tag
      %th Shared Between
      %th Balance
  %tbody
    - balance = @account.balance
    - for entry in @entries
      %tr{:class => cycle("even", "odd")}
        %td= entry.date
        %td= entry.description
        %td
          = link_to image_tag("/images/icons/delete.png"),{:controller=>"entry", :action=>"delete", :id=>entry.id, :account_id=>@account.id}, :confirm=>"Are you sure?"
          = edit_entry_link entry.id
        %td{:class=>entry.amount.to_f > 0 ? "green" : "red"}= number_to_currency(entry.amount)
        %td
          - if entry.tag != nil
            = link_to(entry.tag.name, :controller=>"person", :action=>"tag", :id=>@account.owner.id, :tag_id=>entry.tag.id)
          - else
            = link_to("Untagged", :controller=>"person", :action=>"untagged", :id=>@account.owner.id)
        %td
          - for person in entry.people
            = "#{person.name} "
        %td= number_to_currency(balance)
        - balance -= entry.amount.to_f
    %tr.odd
      %td
      %td Beginning Balance
      %td
      %td= number_to_currency(@account.beginning_balance.to_f)
      %td
      %td
      %td
